<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>criterium.core documentation</title></head><body><div id="header"><h1><a href="index.html">Criterium 0.2.1-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3>Namespaces</h3><ul><li class="current"><a href="criterium.core.html">criterium.core</a></li><li><a href="criterium.stats.html">criterium.stats</a></li><li><a href="criterium.well.html">criterium.well</a></li><li><a href="criterium.ziggurat.html">criterium.ziggurat</a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="criterium.core.html#var-*final-gc-problem-threshold*">*final-gc-problem-threshold*</a></li><li><a href="criterium.core.html#var-*max-gc-attempts*">*max-gc-attempts*</a></li><li><a href="criterium.core.html#var-*sample-count*">*sample-count*</a></li><li><a href="criterium.core.html#var-*target-execution-time*">*target-execution-time*</a></li><li><a href="criterium.core.html#var-*warmup-jit-period*">*warmup-jit-period*</a></li><li><a href="criterium.core.html#var-StateChanged">StateChanged</a></li><li><a href="criterium.core.html#var-bench">bench</a></li><li><a href="criterium.core.html#var-benchmark">benchmark</a></li><li><a href="criterium.core.html#var-benchmark*">benchmark*</a></li><li><a href="criterium.core.html#var-bootstrap">bootstrap</a></li><li><a href="criterium.core.html#var-bootstrap-bca">bootstrap-bca</a></li><li><a href="criterium.core.html#var-estimate-execution-count">estimate-execution-count</a></li><li><a href="criterium.core.html#var-execute-expr">execute-expr</a></li><li><a href="criterium.core.html#var-extract-report-options">extract-report-options</a></li><li><a href="criterium.core.html#var-final-gc">final-gc</a></li><li><a href="criterium.core.html#var-force-gc">force-gc</a></li><li><a href="criterium.core.html#var-heap-used">heap-used</a></li><li><a href="criterium.core.html#var-jvm-compilation-state">jvm-compilation-state</a></li><li><a href="criterium.core.html#var-jvm-jit-name">jvm-jit-name</a></li><li><a href="criterium.core.html#var-memory">memory</a></li><li><a href="criterium.core.html#var-os-details">os-details</a></li><li><a href="criterium.core.html#var-outlier-effect">outlier-effect</a></li><li><a href="criterium.core.html#var-outlier-significance">outlier-significance</a></li><li><a href="criterium.core.html#var-outliers">outliers</a></li><li><a href="criterium.core.html#var-quick-bench">quick-bench</a></li><li><a href="criterium.core.html#var-quick-benchmark">quick-benchmark</a></li><li><a href="criterium.core.html#var-quick-benchmark*">quick-benchmark*</a></li><li><a href="criterium.core.html#var-report">report</a></li><li><a href="criterium.core.html#var-run-benchmark">run-benchmark</a></li><li><a href="criterium.core.html#var-runtime-details">runtime-details</a></li><li><a href="criterium.core.html#var-scale-time">scale-time</a></li><li><a href="criterium.core.html#var-state-changed%3F">state-changed?</a></li><li><a href="criterium.core.html#var-state-delta">state-delta</a></li><li><a href="criterium.core.html#var-system-properties">system-properties</a></li><li><a href="criterium.core.html#var-time-body">time-body</a></li><li><a href="criterium.core.html#var-time-body-with-jvm-state">time-body-with-jvm-state</a></li><li><a href="criterium.core.html#var-timestamp">timestamp</a></li><li><a href="criterium.core.html#var-timestamp-2">timestamp-2</a></li><li><a href="criterium.core.html#var-warmup-for-jit">warmup-for-jit</a></li><li><a href="criterium.core.html#var-with-progress-reporting">with-progress-reporting</a></li></ul></div><div class="namespace-docs" id="content"><h2>criterium.core documentation</h2><pre class="doc">Criterium measures the computation time of an expression.  It is
designed to address some of the pitfalls of benchmarking, and benchmarking on
the JVM in particular.

This includes:
  - statistical processing of multiple evaluations
  - inclusion of a warm-up period, designed to allow the JIT compiler to
    optimise its code
  - purging of gc before testing, to isolate timings from GC state prior
    to testing
  - a final forced GC after testing to estimate impact of cleanup on the
    timing results

Usage:
  (use 'criterium.core)
  (bench (Thread/sleep 1000) :verbose)
  (with-progress-reporting (bench (Thread/sleep 1000) :verbose))
  (report-result (benchmark (Thread/sleep 1000)) :verbose)
  (report-result (quick-bench (Thread/sleep 1000)))

References:
See http://www.ellipticgroup.com/html/benchmarkingArticle.html for a Java
benchmarking library.  The accompanying article describes many of the JVM
benchmarking pitfalls.

See http://hackage.haskell.org/package/criterion for a Haskell benchmarking
library that applies many of the same statistical techniques.</pre><div class="public" id="var-*final-gc-problem-threshold*"><h3>*final-gc-problem-threshold*</h3><div class="usage"></div><pre class="doc">Fraction of excution time allowed for final cleanup before a
warning is issued.</pre></div><div class="public" id="var-*max-gc-attempts*"><h3>*max-gc-attempts*</h3><div class="usage"></div><pre class="doc">Maximum number of attempts to run finalisers and gc.
</pre></div><div class="public" id="var-*sample-count*"><h3>*sample-count*</h3><div class="usage"></div><pre class="doc">Number of executions required
</pre></div><div class="public" id="var-*target-execution-time*"><h3>*target-execution-time*</h3><div class="usage"></div><pre class="doc">Target elapsed time for execution for a single measurement.
</pre></div><div class="public" id="var-*warmup-jit-period*"><h3>*warmup-jit-period*</h3><div class="usage"></div><pre class="doc">Time period used to let the code run so that jit compiler can do
its work.</pre></div><div class="public" id="var-StateChanged"><h3>StateChanged</h3><div class="usage"></div><pre class="doc">Interrogation of differences in a state.
</pre></div><div class="public" id="var-bench"><h3>bench</h3><div class="usage"><code>(bench expr &amp; opts)</code></div><pre class="doc">Convenience macro for benchmarking an expression, expr.  Results are reported
to *out* in human readable format.</pre></div><div class="public" id="var-benchmark"><h3>benchmark</h3><div class="usage"><code>(benchmark expr &amp; options)</code></div><pre class="doc">Benchmark an expression. This tries its best to eliminate sources of error.
This also means that it runs for a while.  It will typically take 70s for a
fast test expression (less than 1s run time) or 10s plus 60 run times for
longer running expressions.</pre></div><div class="public" id="var-benchmark*"><h3>benchmark*</h3><div class="usage"><code>(benchmark* f &amp; {:as options})</code></div><pre class="doc">Benchmark a function. This tries its best to eliminate sources of error.
This also means that it runs for a while.  It will typically take 70s for a
fast test expression (less than 1s run time) or 10s plus 60 run times for
longer running expressions.</pre></div><div class="public" id="var-bootstrap"><h3>bootstrap</h3><div class="usage"><code>(bootstrap data statistic size rng-factory)</code></div><pre class="doc">Bootstrap a statistic. Statistic can produce multiple statistics as a vector
so you can use juxt to pass multiple statistics.
http://en.wikipedia.org/wiki/Bootstrapping_(statistics)</pre></div><div class="public" id="var-bootstrap-bca"><h3>bootstrap-bca</h3><div class="usage"><code>(bootstrap-bca data statistic size alpha rng-factory)</code></div><pre class="doc">Bootstrap a statistic. Statistic can produce multiple statistics as a vector
so you can use juxt to pass multiple statistics.
http://en.wikipedia.org/wiki/Bootstrapping_(statistics)</pre></div><div class="public" id="var-estimate-execution-count"><h3>estimate-execution-count</h3><div class="usage"><code>(estimate-execution-count period f reduce-with)</code></div><pre class="doc">Estimate the number of executions required in order to have at least the
specified execution period, check for the jvm to have constant class loader
and compilation state.</pre></div><div class="public" id="var-execute-expr"><h3>execute-expr</h3><div class="usage"><code>(execute-expr n f reduce-with)</code></div><pre class="doc">A function to execute a function the given number of times, timing the
complete execution.</pre></div><div class="public" id="var-extract-report-options"><h3>extract-report-options</h3><div class="usage"><code>(extract-report-options opts)</code></div><pre class="doc">Extract reporting options from the given options vector.  Returns a two
element vector containing the reporting options followed by the non-reporting
options</pre></div><div class="public" id="var-final-gc"><h3>final-gc</h3><div class="usage"><code>(final-gc execution-time)</code></div><pre class="doc">Time a final clean up of JVM memory. If this time is significant compared to
the runtime, then the runtime should maybe include this time.</pre></div><div class="public" id="var-force-gc"><h3>force-gc</h3><div class="usage"><code>(force-gc)</code><code>(force-gc max-attempts)</code></div><pre class="doc">Force garbage collection and finalisers so that execution time associated
with this is not incurred later. Up to max-attempts are made.</pre></div><div class="public" id="var-heap-used"><h3>heap-used</h3><div class="usage"><code>(heap-used)</code></div><pre class="doc">Report a (inconsistent) snapshot of the heap memory used.
</pre></div><div class="public" id="var-jvm-compilation-state"><h3>jvm-compilation-state</h3><div class="usage"><code>(jvm-compilation-state)</code></div><pre class="doc">Returns the total compilation time for the JVM instance.
</pre></div><div class="public" id="var-jvm-jit-name"><h3>jvm-jit-name</h3><div class="usage"><code>(jvm-jit-name)</code></div><pre class="doc">Returns the name of the JIT compiler.
</pre></div><div class="public" id="var-memory"><h3>memory</h3><div class="usage"><code>(memory)</code></div><pre class="doc">Report a (inconsistent) snapshot of the memory situation.
</pre></div><div class="public" id="var-os-details"><h3>os-details</h3><div class="usage"><code>(os-details)</code></div><pre class="doc">Return the operating system details as a hash.
</pre></div><div class="public" id="var-outlier-effect"><h3>outlier-effect</h3><div class="usage"><code>(outlier-effect var-out-min)</code></div><pre class="doc">Return a keyword describing the effect of outliers on the estimate of mean
runtime.</pre></div><div class="public" id="var-outlier-significance"><h3>outlier-significance</h3><div class="usage"><code>(outlier-significance mean-estimate variance-estimate n)</code></div><pre class="doc">Find the significance of outliers given boostrapped mean and variance
estimates.
See http://www.ellipticgroup.com/misc/article_supplement.pdf, p17.</pre></div><div class="public" id="var-outliers"><h3>outliers</h3><div class="usage"><code>(outliers data)</code></div><pre class="doc">Find the outliers in the data using a boxplot technique.
</pre></div><div class="public" id="var-quick-bench"><h3>quick-bench</h3><div class="usage"><code>(quick-bench expr &amp; opts)</code></div><pre class="doc">Convenience macro for benchmarking an expression, expr.  Results are reported
to *out* in human readable format.</pre></div><div class="public" id="var-quick-benchmark"><h3>quick-benchmark</h3><div class="usage"><code>(quick-benchmark expr &amp; options)</code></div><pre class="doc">Benchmark an expression. Less rigorous benchmark (higher uncertainty).
</pre></div><div class="public" id="var-quick-benchmark*"><h3>quick-benchmark*</h3><div class="usage"><code>(quick-benchmark* f &amp; {:as options})</code></div><pre class="doc">Benchmark an expression. Less rigorous benchmark (higher uncertainty).
</pre></div><div class="public" id="var-report"><h3>report</h3><div class="usage"><code>(report format-string &amp; values)</code></div><pre class="doc">Print format output
</pre></div><div class="public" id="var-run-benchmark"><h3>run-benchmark</h3><div class="usage"><code>(run-benchmark sample-count warmup-jit-period target-execution-time f reduce-with)</code></div><pre class="doc">Benchmark an expression. This tries its best to eliminate sources of error.
This also means that it runs for a while.  It will typically take 70s for a
quick test expression (less than 1s run time) or 10s plus 60 run times for
longer running expressions.</pre></div><div class="public" id="var-runtime-details"><h3>runtime-details</h3><div class="usage"><code>(runtime-details)</code></div><pre class="doc">Return the runtime details as a hash.
</pre></div><div class="public" id="var-scale-time"><h3>scale-time</h3><div class="usage"><code>(scale-time measurement)</code></div><pre class="doc">Determine a scale factor and unit for displaying a time.
</pre></div><div class="public" id="var-state-changed%3F"><h3>state-changed?</h3><div class="usage"><code>(state-changed? state)</code></div><pre class="doc">Check to see if a state delta represents no change
</pre></div><div class="public" id="var-state-delta"><h3>state-delta</h3><div class="usage"><code>(state-delta state-1 state-2)</code></div><pre class="doc">Return a state object for the difference between two states
</pre></div><div class="public" id="var-system-properties"><h3>system-properties</h3><div class="usage"><code>(system-properties)</code></div><pre class="doc">Return the operating system details.
</pre></div><div class="public" id="var-time-body"><h3>time-body</h3><div class="usage"><code>(time-body expr pre)</code><code>(time-body expr)</code></div><pre class="doc">Returns a vector containing execution time and result of specified function.
</pre></div><div class="public" id="var-time-body-with-jvm-state"><h3>time-body-with-jvm-state</h3><div class="usage"><code>(time-body-with-jvm-state expr pre)</code><code>(time-body-with-jvm-state expr)</code></div><pre class="doc">Returns a vector containing execution time, change in loaded and unloaded
class counts, change in compilation time and result of specified function.</pre></div><div class="public" id="var-timestamp"><h3>timestamp</h3><div class="usage"><code>(timestamp)</code></div><pre class="doc">Obtain a timestamp
</pre></div><div class="public" id="var-timestamp-2"><h3>timestamp-2</h3><div class="usage"><code>(timestamp-2)</code></div><pre class="doc">Obtain a timestamp, possibly using MXBean.
</pre></div><div class="public" id="var-warmup-for-jit"><h3>warmup-for-jit</h3><div class="usage"><code>(warmup-for-jit warmup-period f)</code></div><pre class="doc">Run expression for the given amount of time to enable JIT compilation.
</pre></div><div class="public" id="var-with-progress-reporting"><h3>with-progress-reporting</h3><div class="usage"><code>(with-progress-reporting expr)</code></div><pre class="doc">Macro to enable progress reporting during the benchmark.
</pre></div></div></body></html>